# SYSTEM CANON (WHAT IS CANON IN UNIVERSE ENGINE)
FILE: 02_STANDARDS/00_CANON/02__SYSTEM_CANON.md

SCOPE: Universe Engine
LAYER: 02_STANDARDS
DOC_TYPE: CANON_REFERENCE
LEVEL: L1
STATUS: ACTIVE
LOCK: FIXED
VERSION: 1.0.0
UID: UE.CANON.SYSTEM.001
OWNER: SYSTEM
ROLE: Defines what "canon" means in the repository, how it is recognized, what is allowed to exist, and how conflicts are resolved

CHANGE_NOTE:
- DATE: 2026-01-08
- TYPE: MAJOR
- SUMMARY: "Зафиксировано определение канона: existence rule, SoT, anti-duplication, conflict resolution и минимальные условия каноничности"
- REASON: "Без единого определения 'канона' система расползается и любые индексы теряют смысл"
- IMPACT: "Все слои, документы, сущности, пайплайны и будущие переписывания движков"

---

## 0) PURPOSE
Этот документ отвечает на один вопрос:
**что считается каноном** в Universe Engine.

Это не про сюжет/контент. Это про **правило существования** документа/сущности в системе.

---

## 1) CANON DEFINITION (STRICT)
**CANON** — это документ/сущность, которая одновременно удовлетворяет всем условиям:

1) **REGISTERED**  
   Зарегистрирована в master-index соответствующего слоя (existence rule слоя).

2) **DOC CONTROL COMPLIANT**  
   Имеет Doc Control шапку:
   `SCOPE / LAYER / STATUS / LOCK / VERSION / UID / OWNER / ROLE`
   (и любые доп-поля слоя, если требуются).

3) **NAMING COMPLIANT**  
   Имеет имя с номером `NN__...` (или `00__...` только если это entry/README по стандарту слоя).  
   Файлы без номера считаются **ошибкой структуры**.

4) **NON-DUPLICATE**  
   Не создаёт второй источник истины (SoT) для уже существующего смысла.

Если хотя бы один пункт нарушен — это **NON-CANON**.

---

## 2) NON-CANON (WHAT IT IS)
**NON-CANON** — это:
- файл без номера;
- файл не зарегистрирован в master-index слоя;
- файл без Doc Control шапки (для слоёв, где это обязательно);
- дубль смысла существующего SoT;
- “черновик”, который не прошёл путь канонизации.

NON-CANON может физически лежать в репо, но **не существует для системы**.

---

## 3) EXISTENCE RULE (ABSOLUTE)
В каждом слое есть master-index (entrypoint).  
**Если сущности/документа нет в master-index слоя — его не существует для этого слоя.**

Следствие:
- “нашёл файл в дереве” ≠ “существует”
- “есть ссылка где-то” ≠ “существует”

---

## 4) SoT RULE (SINGLE SOURCE OF TRUTH)
**Один смысл → один SoT документ.**  
Всё остальное:
- либо модуль детализации, который НЕ копирует смысл,
- либо ссылки (REL/XREF),
- либо производные артефакты.

Запрещено:
- 2 документа, которые одновременно “главные” по одной теме
- копировать правила целиком в несколько мест

---

## 5) CONFLICT RESOLUTION (HOW WE DECIDE TRUTH)
Истина определяется по приоритету:

1) `01_SYSTEM_LAW/*` — законы системы (верхний уровень)
2) master-index слоя — existence + состав (что существует)
3) SoT спецификации слоя — “как должно быть”
4) протоколы — “как работаем”
5) шаблоны — “форма записи”
6) контент (KB/проекты) — “наполнение”

Если два файла спорят — выигрывает тот, кто **выше по приоритету** и **SoT по смыслу**.

---

## 6) ANTI-DUPLICATION LAW (HARD)
Любая новая сущность/документ перед созданием обязаны пройти проверку:
- существует ли уже SoT по смыслу?
- не создаём ли второй “главный” документ?

Если ответ “да” — новый документ **запрещён**.
Нужно либо:
- расширить существующий SoT,
- либо сделать модуль детализации с XREF,
- либо создать новую сущность с другим смыслом и явными границами.

---

## 7) CANON ACCEPTANCE (MINIMUM GATE)
Документ допускается в канон только если:

- имеет Doc Control шапку
- имеет корректный `VERSION: X.Y.Z`
- имеет `UID`
- имеет имя `NN__...`
- зарегистрирован в master-index слоя
- не является дублем SoT

---

## 8) RENAMES / MOVES (RULE)
Переименование = изменение пути, но не смысла.

Жёсткое правило структуры:
- **после нормализации** старого пути не должно существовать.
- делаем `git mv old -> new`, чтобы не плодить дублей.

---

## FINAL RULE (LOCK)
Этот документ задаёт определение канона для всей системы.
LOCK: FIXED
--- END.

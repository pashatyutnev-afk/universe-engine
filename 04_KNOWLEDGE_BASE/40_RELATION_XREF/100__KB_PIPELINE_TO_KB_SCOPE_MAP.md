# KB XREF — PIPELINE → KB SCOPE MAP (CANON)

FILE: 04_KNOWLEDGE_BASE/40_RELATION_XREF/100__KB_PIPELINE_TO_KB_SCOPE_MAP.md
SCOPE: Universe Engine (Games volume)
SERIAL: C425-B513
LAYER: 04_KNOWLEDGE_BASE
REALM: 40_RELATION_XREF
DOC_TYPE: MAP (KB_XREF)
LEVEL: L2
STATUS: ACTIVE
LOCK: FIXED
VERSION: 1.0.0
UID: UE.KB.XREF.PIPELINE_SCOPE.100
OWNER: SYSTEM
ROLE: Deterministic mapping from allowed PIPELINE_ID to required/optional KB scopes. Enforces KB_SCOPE_RAW presence when pipeline is KB-consuming.

CHANGE_NOTE:
- DATE: 2026-01-20
- TYPE: CREATE
- SUMMARY: "Created pipeline→KB scope map for deterministic KB loading."
- REASON: "Pipelines can be KB-consuming but scopes were not bound explicitly, causing drift."
- IMPACT: "KB-consuming routes now have explicit scope obligations and enforceable stop conditions."
- CHANGE_ID: UE.CHG.2026-01-20.KB.XREF.PIPESCOPE.100

---

## 0) PURPOSE (LAW)
This map defines which KB scopes are required per PIPELINE_ID.
If a pipeline is KB_CONSUMPTION TRUE/CONDITIONAL, it must be represented here.

If KB scope is undefined for a KB-consuming pipeline → STOP: marker not confirmed.

---

## 1) DEFINITIONS
KB_SCOPE is an explicit scope label resolvable to modules via:
- 74__KB_SCOPE_TO_MODULE_LOADING_RULES

KB_SCOPE_RAW is a runtime input containing RAW links to scope definitions (or scope anchors).

---

## 2) MAP FORMAT (CANON)
For each PIPELINE_ID:
- PIPELINE_ID
- DOMAIN
- KB_CONSUMPTION: TRUE|FALSE|CONDITIONAL
- REQUIRED_SCOPES: list (labels)
- OPTIONAL_SCOPES: list (labels)
- REQUIRED_INPUT: KB_SCOPE_RAW (YES|NO|CONDITIONAL)
- NOTES

---

## 3) PIPELINE → SCOPE MAP (INITIAL)

### UE.PIPE.SYSTEM.READINESS.000
DOMAIN: SYSTEM
KB_CONSUMPTION: CONDITIONAL
REQUIRED_SCOPES: []
OPTIONAL_SCOPES: [KB_GOVERNANCE, KB_META]
REQUIRED_INPUT: KB_SCOPE_RAW = NO
NOTES:
- Readiness may inspect KB governance state only.

---

### UE.PIPE.MUSIC.GROUP_TO_ALBUM.101
DOMAIN: MUSIC
KB_CONSUMPTION: FALSE
REQUIRED_SCOPES: []
OPTIONAL_SCOPES: [SOUND_MUSIC, MARKETING]
REQUIRED_INPUT: KB_SCOPE_RAW = NO
NOTES:
- KB optional only.

---

### UE.PIPE.MUSIC.ALBUM_TO_TRACK.102
DOMAIN: MUSIC
KB_CONSUMPTION: CONDITIONAL
REQUIRED_SCOPES: [SOUND_MUSIC]
OPTIONAL_SCOPES: [MARKETING, PRODUCTION]
REQUIRED_INPUT: KB_SCOPE_RAW = CONDITIONAL
NOTES:
- If non-user content/corpus is used → KB_SCOPE_RAW becomes required.

---

### UE.PIPE.MUSIC.TRACK_TEST_GATE.103
DOMAIN: MUSIC
KB_CONSUMPTION: CONDITIONAL
REQUIRED_SCOPES: [SOUND_MUSIC]
OPTIONAL_SCOPES: [CHECKLISTS, QA_RUBRICS]
REQUIRED_INPUT: KB_SCOPE_RAW = CONDITIONAL

---

### UE.PIPE.MUSIC.RELEASE_PACK.104
DOMAIN: MUSIC
KB_CONSUMPTION: CONDITIONAL
REQUIRED_SCOPES: [PRODUCTION, MARKETING]
OPTIONAL_SCOPES: [SOUND_MUSIC]
REQUIRED_INPUT: KB_SCOPE_RAW = CONDITIONAL

---

### UE.PIPE.MUSIC.POET_PACK.105
DOMAIN: MUSIC
KB_CONSUMPTION: TRUE
REQUIRED_SCOPES: [POET_PD_CORPUS]
OPTIONAL_SCOPES: [SOUND_MUSIC]
REQUIRED_INPUT: KB_SCOPE_RAW = YES
NOTES:
- Cannot run without explicit scope + provenance.

---

## 4) ENFORCEMENT (LAW)
If REQUIRED_INPUT=YES and KB_SCOPE_RAW missing → STOP: input absent.
If REQUIRED_SCOPES cannot be resolved via scope→module rules → STOP: marker not confirmed.

---

END.

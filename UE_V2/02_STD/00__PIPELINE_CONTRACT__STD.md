FILE: UE_V2/02_STD/00__PIPELINE_CONTRACT__STD.md
SCOPE: UE_V2 / 02_STD
DOC_TYPE: PIPELINE_CONTRACT
DOMAIN: STD
UID: UE.V2.STD.PIPELINE_CONTRACT.001
VERSION: 1.0.0
STATUS: ACTIVE
MODE: REPO (USAGE-ONLY, NO-EDIT)
CREATED: 2026-01-31
UPDATED: 2026-01-31
OWNER: SYS
NAV_RULE: Contract has no RAW

---

## [M] PURPOSE
PIPELINE_CONTRACT — навигатор работы со стандартами UE_V2 (02_STD).
Не хранит RAW-адреса. Работает через KEY и резолвит адреса в INDEX_MANIFEST.

## [M] HARD_RULES
- Запрещено хранить RAW внутри CONTRACT (без исключений).
- Все обращения: TARGET_KEY -> resolve via INDEX_MANIFEST -> open.
- Выполнение по STEP-RUN: один шаг = одна пачка действий.
- Никаких догадок: SECTION_HINT обязателен.
- Этот контракт предполагает, что весь STD-набор уже существует в INDEX_MANIFEST.

## [M] REQUIRED_KEYS (must exist in INDEX_MANIFEST)
- INDEX_MANIFEST
- PIPELINE_CONTRACT
- STD.DOC_FMT
- STD.NAME_UID
- STD.VER_CHG
- STD.MARKERS
- STD.NAV_RULES
- STD.IDX_RULES
- STD.TPL_RULES
- STD.KB_SCOPE
- STD.GATES
- STD.REPORTS
- STD.PACKAGING
- STD.NOISE_BUDGET
- STD.DICTIONARY_USE
- STD.CONTRIBUTION_TOKEN_FMT
- STD.STEP_TOKEN_SET
- STD.COVERAGE_RULES
- STD.QUESTIONS_GATE
- STD.PIPELINE_STAGE_MODEL
- STD.IO_TYPES
- STD.SYNTHESIS_TOKEN_FMT
- STD.SCORE_RUBRIC_FMT
- STD.COMPONENT_TAGS
- STD.REALM_README_RULES
- STD.ENTITY_ADDRESS_LINE_FMT
- STD.ENTRYPOINT_PATTERN
- STD.SCOPE_GATE_PATTERN

## [M] CONTRACT_HEADER
- REALM_ID: UE_V2/02_STD
- DOMAIN: STD
- ARTIFACT_TYPES: [INDEX, STD, OUTPUT_PACK, LOG]
- DEFAULT_MODE: FAST

## [M] SECTION_SELECTOR (no guessing)
# RULE: SECTION_HINT must match one of these tokens.
- DOC_FMT: STD.DOC_FMT
- NAME_UID: STD.NAME_UID
- VER_CHG: STD.VER_CHG
- MARKERS: STD.MARKERS
- NAV_RULES: STD.NAV_RULES
- IDX_RULES: STD.IDX_RULES
- TPL_RULES: STD.TPL_RULES
- KB_SCOPE: STD.KB_SCOPE
- GATES: STD.GATES
- REPORTS: STD.REPORTS
- PACKAGING: STD.PACKAGING
- NOISE_BUDGET: STD.NOISE_BUDGET
- DICTIONARY_USE: STD.DICTIONARY_USE
- CONTRIBUTION_TOKEN_FMT: STD.CONTRIBUTION_TOKEN_FMT
- STEP_TOKEN_SET: STD.STEP_TOKEN_SET
- COVERAGE_RULES: STD.COVERAGE_RULES
- QUESTIONS_GATE: STD.QUESTIONS_GATE
- PIPELINE_STAGE_MODEL: STD.PIPELINE_STAGE_MODEL
- IO_TYPES: STD.IO_TYPES
- SYNTHESIS_TOKEN_FMT: STD.SYNTHESIS_TOKEN_FMT
- SCORE_RUBRIC_FMT: STD.SCORE_RUBRIC_FMT
- COMPONENT_TAGS: STD.COMPONENT_TAGS
- ENTITY_ADDRESS_LINE_FMT: STD.ENTITY_ADDRESS_LINE_FMT
- ENTRYPOINT_PATTERN: STD.ENTRYPOINT_PATTERN
- SCOPE_GATE_PATTERN: STD.SCOPE_GATE_PATTERN

## [M] FAIL_CODES
- UE.FAIL.INPUT_ABSENT
- UE.FAIL.MISSING_KEY
- UE.FAIL.INVALID_SECTION_HINT
- UE.FAIL.GATE_FAIL

## [M] EXEC_MODEL (how it runs)
1) Resolve INDEX_MANIFEST via KEY: INDEX_MANIFEST
2) Validate REQUIRED_KEYS exist
3) Resolve TARGET_STD_KEY via SECTION_SELECTOR(SECTION_HINT)
4) Open only TARGET_STD_KEY (+ optional SUPPORT_KEYS)
5) Produce OUTPUT_PACK: findings / patch plan / enforcement checklist (NO-EDIT)

## [M] STEP-RUN (canonical)
Each step block format:
- STEP: S<n>
  GOAL: <one line>
  INPUTS: [<tokens>]
  TARGETS: [<KEYS_ONLY>]
  ACTIONS:
    - <imperative action>
  OUTPUTS: [<tokens/artifacts>]
  CHECKS: [<gates>]
  FAIL: <FAIL_CODE_IF_ANY>
  NEXT: "го"

## [M] STEPS

- STEP: S0
  GOAL: Task sanity and section routing
  INPUTS: [TASK_TEXT, SECTION_HINT, MODE_HINT?]
  TARGETS: [INDEX_MANIFEST]
  ACTIONS:
    - Ensure TASK_TEXT exists, else FAIL
    - Ensure SECTION_HINT exists, else FAIL
    - Validate SECTION_HINT is one of SECTION_SELECTOR tokens, else FAIL
    - Decide EXEC_MODE using MODE_HINT or DEFAULT_MODE
  OUTPUTS: [TASK_TOKEN, SECTION_HINT, EXEC_MODE]
  CHECKS: [TASK_PRESENT, SECTION_HINT_VALID]
  FAIL: UE.FAIL.INVALID_SECTION_HINT
  NEXT: "го"

- STEP: S1
  GOAL: Load STD navigation layer and validate readiness
  INPUTS: [TASK_TOKEN]
  TARGETS: [INDEX_MANIFEST, PIPELINE_CONTRACT]
  ACTIONS:
    - Resolve INDEX_MANIFEST via KEY: INDEX_MANIFEST
    - Validate all REQUIRED_KEYS exist in INDEX_MANIFEST ENTRIES
  OUTPUTS: [STD_READY]
  CHECKS: [REQUIRED_KEYS_OK]
  FAIL: UE.FAIL.MISSING_KEY
  NEXT: "го"

- STEP: S2
  GOAL: Open target STD document
  INPUTS: [TASK_TOKEN, SECTION_HINT]
  TARGETS: [INDEX_MANIFEST]
  ACTIONS:
    - Resolve TARGET_STD_KEY via SECTION_SELECTOR(SECTION_HINT)
    - Open TARGET_STD_KEY
    - Optionally open SUPPORT_KEYS if TASK_TOKEN requires (KEYS-only)
  OUTPUTS: [TARGET_STD_KEY, SUPPORT_KEYS?]
  CHECKS: [TARGET_OPENED]
  FAIL: UE.FAIL.MISSING_KEY
  NEXT: "го"

- STEP: S3
  GOAL: Produce enforcement pack (NO-EDIT)
  INPUTS: [TARGET_STD_KEY, SUPPORT_KEYS?, TASK_TOKEN]
  TARGETS: [<KEYS_ONLY>]
  ACTIONS:
    - Produce OUTPUT_PACK: findings + required changes list + gates/checklist
    - Return NEXT prompt
  OUTPUTS: [OUTPUT_PACK, PATCH_PLAN]
  CHECKS: [QUALITY_GATE]
  FAIL: UE.FAIL.GATE_FAIL
  NEXT: "го"

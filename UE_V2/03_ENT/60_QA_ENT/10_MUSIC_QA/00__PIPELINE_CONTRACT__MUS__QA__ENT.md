FILE: UE_V2/03_ENT/60_QA_ENT/10_MUSIC_QA/00__PIPELINE_CONTRACT__MUS__QA__ENT.md
SCOPE: UE_V2 / 03_ENT / 60_QA_ENT / 10_MUSIC_QA
DOC_TYPE: PIPELINE_CONTRACT
DOMAIN: MUS_QA_ENT
UID: UE.V2.ENT.PIPE.MUS_QA_ENT.001
VERSION: 1.0.0
STATUS: ACTIVE
MODE: REPO (USAGE-ONLY, NO-EDIT)
CREATED: 2026-02-02
UPDATED: 2026-02-02
OWNER: QA_ENT
NAV_RULE: Contract has no RAW

---

## [M] PURPOSE
PIPELINE_CONTRACT — роутер музыкального QA.
Возвращает QA_CHAIN_PLAN (KEYS only) и порядок проверки для трека/вариантов/портфеля.
RAW не хранит: всё через KEY и INDEX_MANIFEST.

## [M] HARD_RULES
- RAW запрещён внутри CONTRACT.
- Все ссылки: только KEYS.
- MODE REPO: никаких правок репозитория.
- Выход: QA_CHAIN_PLAN (KEYS) + PRIORITY_ORDER + CONFLICT_RULES.

## [M] REQUIRED_KEYS
- INDEX_MANIFEST
- PIPELINE_CONTRACT
- QA.MUS.TRACK_QA_PANEL

## [M] PRIORITY_ORDER (highest first)
1) QA.MUS.REGRESSION_GUARD
2) QA.MUS.CATALOG_DIFFERENTIATION
3) QA.MUS.VOICE_DIVERSITY_AUDIT
4) QA.MUS.MIX_TRANSLATION
5) QA.MUS.CREATOR_PANEL
6) QA.MUS.HOOK_PANEL
7) QA.MUS.RECOGNITION_10S
8) QA.MUS.SCROLL_STOP_5S
9) QA.MUS.LOOP_15S
10) QA.MUS.TRACK_QA_PANEL

## [M] CONFLICT_RULES
- FAIL dominates everything (stop, return REQUIRED_FIXES + ISSUES).
- ASK dominates PASS/WARN (request missing input).
- WARN returns REQUIRED_FIXES but may continue.
- PASS only when no higher-severity result exists.

## [M] DEFAULT_CHAIN_PLAN (keys)
- ALWAYS:
  - QA.MUS.CREATOR_PANEL
  - QA.MUS.HOOK_PANEL
  - QA.MUS.RECOGNITION_10S
  - QA.MUS.SCROLL_STOP_5S
  - QA.MUS.LOOP_15S
  - QA.MUS.MIX_TRANSLATION
  - QA.MUS.CATALOG_DIFFERENTIATION
  - QA.MUS.REGRESSION_GUARD
  - QA.MUS.TRACK_QA_PANEL
- CONDITIONAL:
  - If portfolio/batch -> add QA.MUS.VOICE_DIVERSITY_AUDIT

## [M] STEP-RUN
- STEP: S0
  GOAL: Build music QA chain keys
  INPUTS: [MUS_BRIEF?, TRACK_TOKEN?, PORTFOLIO_HINTS?]
  TARGETS: [INDEX_MANIFEST]
  ACTIONS:
    - If portfolio -> include VOICE_DIVERSITY_AUDIT
    - Output QA_CHAIN_PLAN
  OUTPUTS: [QA_CHAIN_PLAN]
  CHECKS: [REQUIRED_KEYS_PRESENT]
  FAIL: UE.FAIL.MISSING_KEY
  NEXT: "го"

- STEP: S1
  GOAL: Aggregate QA decisions
  INPUTS: [QA_CHAIN_PLAN, QA_FINDINGS?]
  TARGETS: []
  ACTIONS:
    - Apply checks in PRIORITY_ORDER
    - Aggregate using CONFLICT_RULES
  OUTPUTS: [QA_AGG_DECISION, REQUIRED_FIXES, ISSUES?]
  CHECKS: [DECISION_PRODUCED]
  FAIL: UE.FAIL.GATE_FAIL
  NEXT: "го"

## [M] FAIL_CODES
- UE.FAIL.MISSING_KEY
- UE.FAIL.GATE_FAIL
- UE.FAIL.RULE_VIOLATION
- UE.FAIL.INPUT_ABSENT

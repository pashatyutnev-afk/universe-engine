# ENGINE_LIBRARY/03_ENGINE_TEMPLATES — MAX MONOLITH
## Canonical Templates & Artifact Forms (L0 · Machine Grade)

---

## 0) STATUS

- Layer: L0
- Object: Canonical Templates
- Authority: Governance Layer
- Scope: All ENGINES (L1–L3)
- Usage: Mandatory for new engines, recommended for refactors

Absolute Rule:
> If an Engine does not fit the template, the Engine is wrong.

---

## 1) PURPOSE

This document defines **the only allowed structural forms**
for documenting Engines.

Templates exist to:
- remove ambiguity
- prevent personal styles
- enforce boundaries
- accelerate creation
- enable automated review (checklists & tests)

Templates are **contracts**, not suggestions.

---

## 2) TEMPLATE SELECTION RULE

### Use **MONOLITH TEMPLATE** when:
- Engine is L1 or L2
- Engine affects canon, integrity, governance, audit
- Engine is system-critical
- Engine must never “drift”

### Use **LIGHT TEMPLATE** only when:
- Engine is L3
- Engine is domain/production-only
- Engine has no authority over canon or governance

Default:
> If unsure — use MONOLITH.

---

## 3) TEMPLATE — ENGINE MONOLITH (CANONICAL)

This is the **primary and preferred form**.

### REQUIRED STRUCTURE (NO REORDERING)

---

### 0. CANON STATUS

- Engine ID: `<UNIQUE_ID>`
- Name: `<ENGINE_NAME>`
- Class: `<Governance | Service | Domain>`
- Level: `<L1 | L2 | L3>`
- Status: `<DRAFT | BETA | FINAL>`
- Authority: `<Who approves>`
- Failure Mode: `<Fail-Closed | Fail-Open>`

**Absolute Rule:**  
`<one sentence, non-negotiable>`

---

### 1. PURPOSE

- Engine exists to: `<1–2 sentences>`
- Engine must NOT: `<explicit non-goals>`

If this section exceeds 2–3 short paragraphs → FAIL.

---

### 2. SCOPE

**In-Scope**
- `<concrete action>`
- `<concrete action>`

**Out-of-Scope (FORBIDDEN)**
- `<explicitly forbidden responsibility>`
- `<explicitly forbidden responsibility>`

Out-of-Scope is mandatory.
Missing Out-of-Scope → FAIL.

---

### 3. INTERFACES & ACCESS

Define **all** interfaces explicitly.

**Request**
- Who can request:
- Required inputs:
- Rejection conditions:

**Execute**
- Who can execute:
- Preconditions:
- Forbidden executors:

**Read**
- Who can read:
- What can be read:

**Write**
- Who can write:
- What can be written:

Implicit interfaces are forbidden.

---

### 4. PROTOCOL (PROTOCOL-FIRST)

Canonical order (must be followed):

1) Trigger / Receive Request  
2) Validate (schema, rules, taxonomy)  
3) Authorize (Governance, if required)  
4) Execute (engine action)  
5) Produce Audit Fact (via trace, if applicable)  
6) Return Result (artifact + status)

Each step MUST specify:
- entry condition
- exit condition
- failure outcome

---

### 5. RULES

**Absolute Rules (FORBIDDEN)**
- `<hard prohibition>`
- `<hard prohibition>`

**Content Rules (ALLOWED ONLY IF)**
- `<formal condition>`
- `<formal condition>`

Rules override protocol if in conflict.

---

### 6. FAILURE & VIOLATIONS

**Severity Levels**
- CRITICAL:
- MAJOR:
- MINOR:

**Reactions**
- CRITICAL → `<halt / escalate>`
- MAJOR → `<reject / degrade>`
- MINOR → `<warn / adjust>`

Silent failure is forbidden.

---

### 7. TRACE & AUDIT COMPATIBILITY

If engine participates in multi-step flows:

- Accepts incoming `trace_id`: `<yes/no>`
- Emits new `trace_id`: `<yes/no>`
- Audit facts produced for:
  - attempt
  - success
  - failure
  - rejection

Undefined audit behaviour → FAIL.

---

### 8. DEPENDENCIES & COUPLING

**Dependencies**
- `<Engine / Layer>`

**Forbidden Couplings**
- `<explicitly forbidden dependency>`

Circular dependency in L1 → CRITICAL.

---

### 9. GOVERNANCE POSITION

- Does this engine affect Canon? `<yes/no>`
- Approval required? `<yes/no>`
- Who approves? `<role/engine>`
- Can this engine self-approve? `NO`

---

### 10. CANON STATEMENT

`<One line that defines the engine's immovable truth>`

---

## 4) TEMPLATE — ENGINE LIGHT (L3 ONLY)

Allowed **only** for non-critical L3 engines.

### Required Sections
- Canon Status
- Purpose
- Scope (In/Out)
- Protocol (simplified)
- Rules (minimal)
- Failure (at least CRITICAL)
- Canon Statement

If Light template grows beyond these → migrate to Monolith.

---

## 5) STANDARD ARTIFACT FORMS (ENGINE-LEVEL)

These forms may be referenced in Protocols.

### ENGINE_REQUEST

Required fields:
- trace_id (or request generates it)
- requester_type
- requester_id
- engine_id
- intent_ref
- payload
- constraints

---

### ENGINE_RESULT

Required fields:
- trace_id
- status (success / failure / reject)
- artifact_ref
- errors (if any)
- references (canon / knowledge)

---

### ENGINE_VIOLATION

Required fields:
- trace_id
- violation_type
- severity
- description
- reaction

---

## 6) NAMING & ID STANDARDS

- Engine ID: `L<level>-<DOMAIN>-<NAME>-###`
- trace_id: system-generated, immutable
- intent_id: generated by Specialist
- artifact_ref: stable, versioned

Ad-hoc naming is forbidden.

---

## 7) TEMPLATE ANTI-PATTERNS (AUTO-FAIL)

If present → redesign required:

- Missing Out-of-Scope
- Implicit Execute access
- “Engine decides if allowed”
- “Protocol optional”
- Undefined failure behaviour
- Flexible terminology
- Editable history

---

## 8) CANON STATEMENT

Templates are compression of discipline.
They make complexity survivable.

# ⚠️ TENSION & STAKES ENGINE
## Каноническая монолитная спецификация движка напряжения и ставок  
**Уровень L2 · Narrative Engine · Угрозы и цена исхода · Machine-grade**

---

## 0. КАНОНИЧЕСКИЙ СТАТУС

- Engine ID: **L2-NAR-TENSION-STAKES-001**
- Название: Tension & Stakes Engine
- Класс: Narrative Engine
- Уровень: **L2 (Narrative Core)**
- Статус: **FINAL**
- Подконтролен: Governance Layer
- Failure Mode: **fail-closed**
- Аудит: через Audit Log Engine (при фиксации)
- Архитектурный паттерн: **Threat / Stakes Evaluation Engine**

### Абсолютное правило
> Если цена провала не ясна —  
> напряжение не работает.

---

## 1. НАЗНАЧЕНИЕ

Tension & Stakes Engine отвечает за **формирование и контроль напряжения через ставки**.

Он:
- определяет, что персонажи могут потерять или приобрести
- калибрует уровень угроз
- усиливает драматическое давление
- предотвращает «фальшивое напряжение»
- синхронизирует ставки с драматической дугой

Он **НЕ**:
- создаёт события
- решает исход
- управляет темпом
- проверяет логику мира

---

## 2. ОБЛАСТЬ ДЕЙСТВИЯ (SCOPE)

### In-Scope (РАЗРЕШЕНО)

- Определение ставок сцен и арок
- Классификация типов угроз
- Проверка роста напряжения
- Контроль соразмерности угроз
- Проверка последствий проигрыша и выигрыша

### Out-of-Scope (ЗАПРЕЩЕНО)

- Искусственное нагнетание без последствий
- Обесценивание угроз
- Удаление последствий ради комфорта
- Повышение ставок без подготовки

Out-of-Scope абсолютен.

---

## 3. МОДЕЛЬ СТАВОК (STAKES_MODEL)

### Типы ставок

- `personal_stakes` — жизнь, здоровье, отношения
- `moral_stakes` — ценности, выбор, вина
- `social_stakes` — статус, репутация, доверие
- `material_stakes` — ресурсы, территории
- `existential_stakes` — мир, цивилизация, выживание
- `identity_stakes` — кто я после этого

Каждая сцена с конфликтом ОБЯЗАНА иметь хотя бы один тип ставок.

---

## 4. УРОВНИ УГРОЗ (THREAT_LEVEL)

- `low` — риск минимален
- `medium` — ощутимая потеря
- `high` — серьёзные последствия
- `critical` — необратимый ущерб

### Абсолютное правило
> Кульминация требует `high` или `critical`.

---

## 5. ДИНАМИКА НАПРЯЖЕНИЯ (TENSION_CURVE)

Напряжение должно:
- расти по мере приближения к кульминации
- иметь локальные пики и спады
- соответствовать ставкам

Постоянный `critical` → **обесценивание**.

---

## 6. МОДЕЛЬ ДОСТУПА

### Request

**Разрешены:**
- Dramatic Arc Engine
- Scene Construction Engine
- Story Structure Engine
- Pacing & Rhythm Engine

**Запрещены:**
- Specialists напрямую
- Production Engines
- Knowledge Base

---

### Execute

- **ЗАПРЕЩЕНО**

Tension & Stakes Engine не исполняет контент.

---

### Read

- Все Narrative Engines
- Governance (read-only)
- Аналитика (read-only)

---

### Write

- Только аналитические результаты (при фиксации — audit)

---

## 7. ВХОДНОЙ АРТЕФАКТ — STAKES_REQUEST

### Обязательные поля

- `stakes_id`
- `trace_id`
- `story_scope`
- `conflict_map`
- `characters_involved`
- `current_arc_phase`
- `constraints`

Отсутствие любого поля → **rejected**.

---

## 8. ВЫХОДНОЙ АРТЕФАКТ — STAKES_PROFILE

### Обязательные поля

- `stakes_id`
- `trace_id`
- `stakes_types`
- `threat_levels`
- `tension_curve_alignment`
- `validation_status`
- `notes`
- `timestamp`

Профиль неизменяем после фиксации.

---

## 9. ПРОТОКОЛ ОЦЕНКИ НАПРЯЖЕНИЯ

1. Получить Stakes Request  
2. Проверить схему и trace  
3. Идентифицировать типы ставок  
4. Назначить уровни угроз  
5. Проверить рост напряжения  
6. Проверить соответствие дуге  
7. Выявить обесценивание или скачки  
8. Сформировать Stakes Profile  
9. Вернуть результат инициатору  

Пропуск шага → **CRITICAL нарушение**.

---

## 10. ПРАВИЛА (ABSOLUTE)

- Ставки должны быть понятны
- Угрозы должны быть реальны
- Последствия обязательны
- Рост важнее шума
- Победа тоже имеет цену

Правила сильнее протокола.

---

## 11. ОШИБКИ И НАРУШЕНИЯ

### CRITICAL

- Отсутствие ставок
- Кульминация без цены
- Игнорирование последствий

**Реакция:**
- Блокировка narrative pipeline
- Возврат на переработку
- Фиксация инцидента (при фиксации)

---

### MAJOR

- Слабые ставки
- Несоразмерные угрозы

**Реакция:** возврат на доработку

---

### MINOR

- Неточности формулировок

**Реакция:** допускается уточнение

---

## 12. TRACE И АУДИТ

- Все профили привязаны к `trace_id`
- Фиксация профиля = auditable fact
- Блокировки фиксируются отдельно

---

## 13. ЗАВИСИМОСТИ

### Обязательные

- Dramatic Arc Engine
- Narrative Logic Engine
- Pacing & Rhythm Engine
- Audit Log Engine (при фиксации)

### Запрещённые

- Production Engines
- Specialists как инициаторы
- Knowledge Base как источник решений

---

## 14. GOVERNANCE-ПОЗИЦИЯ

Tension & Stakes Engine:
- делает конфликт значимым
- заставляет переживать
- не создаёт события
- не решает исход

Без ставки  
нет напряжения.

---

## 15. КАНОНИЧЕСКОЕ УТВЕРЖДЕНИЕ

Цена ошибки —  
двигатель драмы.

---

**СТАТУС:** Tension & Stakes Engine v1.0 — **FINAL · КАНОН ЗАФИКСИРОВАН**
